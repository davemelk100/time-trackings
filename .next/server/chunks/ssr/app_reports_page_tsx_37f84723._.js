module.exports=[77363,a=>{"use strict";var b=a.i(87924),c=a.i(69265),d=a.i(85808),e=a.i(72131),f=a.i(3130),g=a.i(5522),h=a.i(17171),i=a.i(40695),j=a.i(88237),k=a.i(87682),l=a.i(70106);let m=(0,l.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),n=(0,l.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);var o=a.i(33508),p=a.i(40622),q=a.i(78560),r=a.i(21937);function s(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(a)}function t(a){let b=new Date(a+"T00:00:00");return`${String(b.getMonth()+1).padStart(2,"0")}/${String(b.getDate()).padStart(2,"0")}/${b.getFullYear()}`}function u(){let{supabase:a}=(0,r.useAuth)(),[c,d]=(0,e.useState)([]),[l,u]=(0,e.useState)([]),[v,w]=(0,e.useState)([]),[x,y]=(0,e.useState)([]),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(null),[D,E]=(0,e.useState)("all"),[F,G]=(0,e.useState)("all"),[H,I]=(0,e.useState)(""),[J,K]=(0,e.useState)(""),[L,M]=(0,e.useState)(""),[N,O]=(0,e.useState)("date"),[P,Q]=(0,e.useState)("desc"),[R,S]=(0,e.useState)("name"),[T,U]=(0,e.useState)("asc");(0,e.useEffect)(()=>{let b=!1;return A(!1),C(null),async function(){try{let[c,e,f,g]=await Promise.all([(0,q.fetchClients)(a),(0,q.fetchAllTimeEntries)(a),(0,q.fetchAllSubscriptions)(a),(0,q.fetchAllPayables)(a)]);if(b)return;d(c.length>0?c:p.defaultClients),u(e),w(f),y(g)}catch(a){b||(d(p.defaultClients),C(a instanceof Error?a.message:"Failed to load data"))}finally{b||A(!0)}}(),()=>{b=!0}},[a]);let V=(0,e.useMemo)(()=>{let a={};for(let b of c)a[b.id]=b.name;return a},[c]),W=(0,e.useMemo)(()=>{let a={};for(let b of c)a[b.id]=b.hourlyRate;return a},[c]),X=(0,e.useMemo)(()=>{let a={};for(let b of c)a[b.id]=b.flatRate;return a},[c]);function Y(a){return V[a]??a}function Z(a){return W[a]??null}function $(a){return X[a]??null}let _=(0,e.useMemo)(()=>{let a=new Set;for(let b of l)a.add(b.date.slice(0,7));return Array.from(a).sort().reverse()},[l]),aa="all"!==D||"all"!==F||""!==H||""!==J||""!==L,ab=(0,e.useMemo)(()=>{let a=L.toLowerCase();return l.filter(b=>("all"===D||b.clientId===D)&&("all"===F||!!b.date.startsWith(F))&&(!H||!(b.date<H))&&(!J||!(b.date>J))&&(!a||!!b.tasks.toLowerCase().includes(a)||!!b.notes.toLowerCase().includes(a)))},[l,D,F,H,J,L]),ac=(0,e.useMemo)(()=>{let a=L.toLowerCase();return v.filter(b=>("all"===D||b.clientId===D)&&(!a||!!b.name.toLowerCase().includes(a)||!!b.category.toLowerCase().includes(a)||!!b.notes.toLowerCase().includes(a)))},[v,D,L]),ad=(0,e.useMemo)(()=>{let a=[...ab];return a.sort((a,b)=>{let c=0;return c="date"===N?a.date.localeCompare(b.date):"hours"===N?a.totalHours-b.totalHours:a.totalHours*(Z(a.clientId)??0)-b.totalHours*(Z(b.clientId)??0),"asc"===P?c:-c}),a},[ab,N,P]),ae=(0,e.useMemo)(()=>{let a=[...ac];return a.sort((a,b)=>{let c=0;return c="name"===R?a.name.localeCompare(b.name):"category"===R?a.category.localeCompare(b.category):("monthly"===a.billingCycle?12*a.amount:a.amount)-("monthly"===b.billingCycle?12*b.amount:b.amount),"asc"===T?c:-c}),a},[ac,R,T]),af=(0,e.useMemo)(()=>{let a=L.toLowerCase();return x.filter(b=>"nextier"!==b.clientId&&("all"===D||b.clientId===D)&&(!a||!!b.description.toLowerCase().includes(a)||!!b.notes.toLowerCase().includes(a)))},[x,D,L]),ag=ab.reduce((a,b)=>a+b.totalHours,0),ah=ab.reduce((a,b)=>null!=$(b.clientId)?a:a+b.totalHours*(Z(b.clientId)??0),0)+Array.from(new Set(ab.map(a=>a.clientId).filter(a=>null!=$(a)))).reduce((a,b)=>a+($(b)??0),0),ai=12*ac.reduce((a,b)=>"monthly"===b.billingCycle?a+b.amount:a+b.amount/12,0),aj=af.reduce((a,b)=>a+b.amount,0),ak=(0,e.useMemo)(()=>{let a={};for(let b of ab){let c=$(b.clientId);null!=c?a[b.clientId]=c:a[b.clientId]=(a[b.clientId]??0)+b.totalHours*(Z(b.clientId)??0)}return Object.entries(a).sort(([a],[b])=>Y(a).localeCompare(Y(b)))},[ab,W,X,V]),al=(0,e.useMemo)(()=>{let a={};for(let b of ac){let c="monthly"===b.billingCycle?12*b.amount:b.amount;a[b.clientId]=(a[b.clientId]??0)+c}return Object.entries(a).sort(([a],[b])=>Y(a).localeCompare(Y(b)))},[ac,V]),am=(0,e.useMemo)(()=>{let a={};for(let b of af)a[b.clientId]=(a[b.clientId]??0)+b.amount;return Object.entries(a).sort(([a],[b])=>Y(a).localeCompare(Y(b)))},[af,V]);function an(a){N===a?Q(a=>"asc"===a?"desc":"asc"):(O(a),Q("desc"))}function ao(a){R===a?U(a=>"asc"===a?"desc":"asc"):(S(a),U("amount"===a?"desc":"asc"))}function ap({column:a}){return N!==a?null:"asc"===P?(0,b.jsx)(m,{className:"inline h-3 w-3 ml-1"}):(0,b.jsx)(n,{className:"inline h-3 w-3 ml-1"})}function aq({column:a}){return R!==a?null:"asc"===T?(0,b.jsx)(m,{className:"inline h-3 w-3 ml-1"}):(0,b.jsx)(n,{className:"inline h-3 w-3 ml-1"})}return z?(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[B&&(0,b.jsx)(f.Card,{className:"border-destructive",children:(0,b.jsxs)(f.CardContent,{className:"p-4 text-destructive",children:[B,(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"ml-2",onClick:()=>C(null),children:"Dismiss"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5 print:hidden",children:[(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Time Entries"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:ab.length})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total Hours"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold font-mono",children:ag.toFixed(2)})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Hourly Cost"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold font-mono text-primary",children:s(ah)})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Subscriptions"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("p",{className:"text-2xl font-bold font-mono text-primary",children:[s(ai),(0,b.jsx)("span",{className:"ml-1 text-sm font-normal text-muted-foreground",children:"/yr"})]})})]}),aj>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"pb-2",children:(0,b.jsx)(f.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Payables"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold font-mono text-destructive",children:s(aj)})})]})]}),(0,b.jsxs)(f.Card,{className:"print:hidden",children:[(0,b.jsx)(f.CardHeader,{className:"pb-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(f.CardTitle,{children:"Filters"}),aa&&(0,b.jsxs)(i.Button,{variant:"ghost",size:"sm",onClick:function(){E("all"),G("all"),I(""),K(""),M("")},children:[(0,b.jsx)(o.X,{className:"mr-1.5 h-3.5 w-3.5"}),"Clear Filters"]})]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,b.jsx)(h.Label,{children:"Client"}),(0,b.jsxs)(k.Select,{value:D,onValueChange:E,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"all",children:"All Clients"}),c.map(a=>(0,b.jsx)(k.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,b.jsx)(h.Label,{children:"Month"}),(0,b.jsxs)(k.Select,{value:F,onValueChange:G,children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"all",children:"All Months"}),_.map(a=>{let[c,d]=a.split("-"),e=new Date(Number(c),Number(d)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"});return(0,b.jsx)(k.SelectItem,{value:a,children:e},a)})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,b.jsx)(h.Label,{children:"Date From"}),(0,b.jsx)(g.Input,{type:"date",value:H,onChange:a=>I(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,b.jsx)(h.Label,{children:"Date To"}),(0,b.jsx)(g.Input,{type:"date",value:J,onChange:a=>K(a.target.value)})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,b.jsx)(h.Label,{children:"Search"}),(0,b.jsx)(g.Input,{type:"text",placeholder:"Search tasks/notes/names...",value:L,onChange:a=>M(a.target.value)})]})]})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Time Entries"})}),(0,b.jsx)(f.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none w-[110px]",onClick:()=>an("date"),children:["Date",(0,b.jsx)(ap,{column:"date"})]}),(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsx)(j.TableHead,{children:"Tasks"}),(0,b.jsx)(j.TableHead,{children:"Time Range"}),(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none text-right w-[80px]",onClick:()=>an("hours"),children:["Hours",(0,b.jsx)(ap,{column:"hours"})]}),(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none text-right w-[100px]",onClick:()=>an("cost"),children:["Cost",(0,b.jsx)(ap,{column:"cost"})]})]})}),(0,b.jsx)(j.TableBody,{children:0===ad.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"py-8 text-center text-muted-foreground",children:"No time entries match the current filters."})}):ad.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap font-medium",children:t(a.date)}),(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap",children:Y(a.clientId)}),(0,b.jsx)(j.TableCell,{className:"max-w-[220px] text-muted-foreground",children:a.tasks}),(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap",children:a.timeRange}),(0,b.jsx)(j.TableCell,{className:"text-right font-mono",children:a.totalHours.toFixed(2)}),(0,b.jsx)(j.TableCell,{className:"text-right font-mono text-muted-foreground",children:null!=$(a.clientId)?"—":null!=Z(a.clientId)?s(a.totalHours*Z(a.clientId)):"TBD"})]},a.id))}),ad.length>0&&(0,b.jsx)(j.TableFooter,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{colSpan:4,className:"font-semibold",children:"Total"}),(0,b.jsx)(j.TableCell,{className:"text-right font-mono font-semibold",children:ag.toFixed(2)}),(0,b.jsx)(j.TableCell,{className:"text-right font-mono font-semibold text-primary",children:s(ah)})]})})]})})})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Software Subscriptions"})}),(0,b.jsx)(f.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none",onClick:()=>ao("name"),children:["Name",(0,b.jsx)(aq,{column:"name"})]}),(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none",onClick:()=>ao("category"),children:["Category",(0,b.jsx)(aq,{column:"category"})]}),(0,b.jsx)(j.TableHead,{className:"w-[110px]",children:"Billing Cycle"}),(0,b.jsx)(j.TableHead,{className:"w-[110px]",children:"Renewal Date"}),(0,b.jsxs)(j.TableHead,{className:"cursor-pointer select-none text-right w-[100px]",onClick:()=>ao("amount"),children:["Amount",(0,b.jsx)(aq,{column:"amount"})]})]})}),(0,b.jsx)(j.TableBody,{children:0===ae.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:6,className:"py-8 text-center text-muted-foreground",children:"No subscriptions match the current filters."})}):ae.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap",children:Y(a.clientId)}),(0,b.jsx)(j.TableCell,{className:"text-muted-foreground",children:a.category}),(0,b.jsx)(j.TableCell,{className:"capitalize",children:a.billingCycle}),(0,b.jsx)(j.TableCell,{className:"text-muted-foreground",children:a.renewalDate?t(a.renewalDate):"—"}),(0,b.jsxs)(j.TableCell,{className:"text-right font-mono",children:[s(a.amount),(0,b.jsxs)("span",{className:"ml-1 text-muted-foreground",children:["/","monthly"===a.billingCycle?"mo":"yr"]})]})]},a.id))}),ae.length>0&&(0,b.jsx)(j.TableFooter,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{colSpan:5,className:"font-semibold",children:"Total"}),(0,b.jsxs)(j.TableCell,{className:"text-right font-mono font-semibold text-primary",children:[s(ai),(0,b.jsx)("span",{className:"ml-1 font-normal text-muted-foreground",children:"/yr"})]})]})})]})})})]}),af.length>0&&(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Payables"})}),(0,b.jsx)(f.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{className:"w-[110px]",children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Client"}),(0,b.jsx)(j.TableHead,{children:"Description"}),(0,b.jsx)(j.TableHead,{children:"Notes"}),(0,b.jsx)(j.TableHead,{className:"text-right w-[100px]",children:"Amount"})]})}),(0,b.jsx)(j.TableBody,{children:af.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap font-medium",children:t(a.date)}),(0,b.jsx)(j.TableCell,{className:"whitespace-nowrap",children:Y(a.clientId)}),(0,b.jsx)(j.TableCell,{className:"max-w-[200px]",children:a.description}),(0,b.jsx)(j.TableCell,{className:"max-w-[160px] text-muted-foreground",children:a.notes||"—"}),(0,b.jsxs)(j.TableCell,{className:"text-right font-mono text-destructive",children:["−",s(a.amount)]})]},a.id))}),(0,b.jsx)(j.TableFooter,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{colSpan:4,className:"font-semibold",children:"Total"}),(0,b.jsxs)(j.TableCell,{className:"text-right font-mono font-semibold text-destructive",children:["−",s(aj)]})]})})]})})})]}),(0,b.jsxs)(f.Card,{className:"ml-auto sm:max-w-[60%]",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsx)(f.CardTitle,{children:"Total"})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsxs)("div",{className:"flex flex-col items-end w-full",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-0.5 items-end w-full text-muted-foreground",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:"Time Tracking"}),ak.map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,b.jsx)("span",{children:Y(a)}),(0,b.jsx)("span",{className:"font-mono",children:s(c)})]},a)),(0,b.jsx)("div",{className:"border-t border-border pt-0.5 w-full text-right",children:(0,b.jsx)("span",{className:"font-mono font-semibold",children:s(ah)})})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-0.5 items-end w-full text-muted-foreground mt-3",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:"Subscriptions"}),al.map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,b.jsx)("span",{children:Y(a)}),(0,b.jsxs)("span",{className:"font-mono",children:[s(c),(0,b.jsx)("span",{className:"ml-1 text-muted-foreground",children:"/yr"})]})]},a)),(0,b.jsx)("div",{className:"border-t border-border pt-0.5 w-full text-right",children:(0,b.jsxs)("span",{className:"font-mono font-semibold",children:[s(ai),(0,b.jsx)("span",{className:"ml-1 font-normal text-muted-foreground",children:"/yr"})]})})]}),aj>0&&(0,b.jsxs)("div",{className:"flex flex-col gap-0.5 items-end w-full text-muted-foreground mt-3",children:[(0,b.jsx)("span",{className:"font-medium text-foreground",children:"Payables"}),am.map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,b.jsx)("span",{children:Y(a)}),(0,b.jsxs)("span",{className:"font-mono",children:["−",s(c)]})]},a)),(0,b.jsx)("div",{className:"border-t border-border pt-0.5 w-full text-right",children:(0,b.jsxs)("span",{className:"font-mono font-semibold",children:["−",s(aj)]})})]}),(0,b.jsx)("div",{className:"mt-3 border-t-2 border-border pt-1 w-full text-right",children:(0,b.jsx)("span",{className:"font-mono font-bold text-primary",children:s(ah+ai-aj)})})]})})})]})]}):(0,b.jsx)(f.Card,{children:(0,b.jsx)(f.CardContent,{className:"p-8 text-center text-muted-foreground",children:"Loading reports..."})})}function v(){return(0,b.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,b.jsx)(c.DashboardHeader,{clientName:"Reports"}),(0,b.jsx)("main",{className:"mx-auto w-full max-w-7xl flex-1 px-4 py-6 sm:px-6 lg:px-8 flex flex-col gap-8",children:(0,b.jsx)(u,{})}),(0,b.jsx)(d.DashboardFooter,{})]})}a.s(["default",()=>v],77363)}];

//# sourceMappingURL=app_reports_page_tsx_37f84723._.js.map